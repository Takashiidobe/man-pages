.. container:: page-top

.. container:: nav-bar

   +----------------------------------+----------------------------------+
   | `m                               | `Linux/UNIX system programming   |
   | an7.org <../../../index.html>`__ | trainin                          |
   | > Linux >                        | g <http://man7.org/training/>`__ |
   | `man-pages <../index.html>`__    |                                  |
   +----------------------------------+----------------------------------+

--------------

pcap_set_protocol_linux(3pcap) — Linux manual page
==================================================

+-----------------------------------+-----------------------------------+
| `NAME <#NAME>`__ \|               |                                   |
| `SYNOPSIS <#SYNOPSIS>`__ \|       |                                   |
| `DESCRIPTION <#DESCRIPTION>`__ \| |                                   |
| `RETURN VALUE <#RETURN_VALUE>`__  |                                   |
| \|                                |                                   |
| `BACKWARD COMPATIBI               |                                   |
| LITY <#BACKWARD_COMPATIBILITY>`__ |                                   |
| \| `SEE ALSO <#SEE_ALSO>`__ \|    |                                   |
| `COLOPHON <#COLOPHON>`__          |                                   |
+-----------------------------------+-----------------------------------+
| .. container:: man-search-box     |                                   |
+-----------------------------------+-----------------------------------+

::

   PCAP_SET_PROTOCOL_LINUX(3PCAP)            PCAP_SET_PROTOCOL_LINUX(3PCAP)

NAME
-------------------------------------------------

::

          pcap_set_protocol_linux - set capture protocol for a not-yet-
          activated capture handle


---------------------------------------------------------

::

          #include <pcap/pcap.h>

          int pcap_set_protocol_linux(pcap_t *p, int protocol);


---------------------------------------------------------------

::

          On network interface devices on Linux, pcap_set_protocol_linux()
          sets the protocol to be used in the socket(2) call to create a
          capture socket when the handle is activated.  The argument is a
          link-layer protocol value, such as the values in the
          <linux/if_ether.h> header file, specified in host byte order.  If
          protocol is non-zero, packets of that protocol will be captured
          when the handle is activated, otherwise, all packets will be
          captured.  This function is only provided on Linux, and, if it is
          used on any device other than a network interface, it will have
          no effect.

          It should not be used in portable code; instead, a filter should
          be specified with pcap_setfilter(3PCAP).

          If a given network interface provides a standard link-layer
          header, with a standard packet type, but provides some packet
          types with a different socket-layer protocol type from the one in
          the link-layer header, that packet type cannot be filtered with a
          filter specified with pcap_setfilter() but can be filtered by
          specifying the socket-layer protocol type using
          pcap_set_protocol_linux().


-----------------------------------------------------------------

::

          pcap_set_protocol_linux() returns 0 on success or
          PCAP_ERROR_ACTIVATED if called on a capture handle that has been
          activated.


-------------------------------------------------------------------------------------

::

          This function became available in libpcap release 1.9.0.


---------------------------------------------------------

::

          pcap(3PCAP), pcap_create(3PCAP), pcap_activate(3PCAP)

COLOPHON
---------------------------------------------------------

::

          This page is part of the libpcap (packet capture library)
          project.  Information about the project can be found at 
          ⟨http://www.tcpdump.org/⟩.  If you have a bug report for this
          manual page, see ⟨http://www.tcpdump.org/#patches⟩.  This page
          was obtained from the project's upstream Git repository
          ⟨https://github.com/the-tcpdump-group/libpcap.git⟩ on 2021-08-27.
          (At that time, the date of the most recent commit that was found
          in the repository was 2021-08-17.)  If you discover any rendering
          problems in this HTML version of the page, or you believe there
          is a better or more up-to-date source for the page, or you have
          corrections or improvements to the information in this COLOPHON
          (which is not part of the original manual page), send a mail to
          man-pages@man7.org

                                22 August 2018PCAP_SET_PROTOCOL_LINUX(3PCAP)

--------------

--------------

.. container:: footer

   +-----------------------+-----------------------+-----------------------+
   | HTML rendering        |                       | |Cover of TLPI|       |
   | created 2021-08-27 by |                       |                       |
   | `Michael              |                       |                       |
   | Ker                   |                       |                       |
   | risk <https://man7.or |                       |                       |
   | g/mtk/index.html>`__, |                       |                       |
   | author of `The Linux  |                       |                       |
   | Programming           |                       |                       |
   | Interface <https:     |                       |                       |
   | //man7.org/tlpi/>`__, |                       |                       |
   | maintainer of the     |                       |                       |
   | `Linux man-pages      |                       |                       |
   | project <             |                       |                       |
   | https://www.kernel.or |                       |                       |
   | g/doc/man-pages/>`__. |                       |                       |
   |                       |                       |                       |
   | For details of        |                       |                       |
   | in-depth **Linux/UNIX |                       |                       |
   | system programming    |                       |                       |
   | training courses**    |                       |                       |
   | that I teach, look    |                       |                       |
   | `here <https://ma     |                       |                       |
   | n7.org/training/>`__. |                       |                       |
   |                       |                       |                       |
   | Hosting by `jambit    |                       |                       |
   | GmbH                  |                       |                       |
   | <https://www.jambit.c |                       |                       |
   | om/index_en.html>`__. |                       |                       |
   +-----------------------+-----------------------+-----------------------+

--------------

.. container:: statcounter

   |Web Analytics Made Easy - StatCounter|

.. |Cover of TLPI| image:: https://man7.org/tlpi/cover/TLPI-front-cover-vsmall.png
   :target: https://man7.org/tlpi/
.. |Web Analytics Made Easy - StatCounter| image:: https://c.statcounter.com/7422636/0/9b6714ff/1/
   :class: statcounter
   :target: https://statcounter.com/
