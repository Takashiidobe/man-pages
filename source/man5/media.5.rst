.. container:: page-top

.. container:: nav-bar

   +----------------------------------+----------------------------------+
   | `m                               | `Linux/UNIX system programming   |
   | an7.org <../../../index.html>`__ | trainin                          |
   | > Linux >                        | g <http://man7.org/training/>`__ |
   | `man-pages <../index.html>`__    |                                  |
   +----------------------------------+----------------------------------+

--------------

selabel_media(5) — Linux manual page
====================================

+-----------------------------------+-----------------------------------+
| `NAME <#NAME>`__ \|               |                                   |
| `SYNOPSIS <#SYNOPSIS>`__ \|       |                                   |
| `DESCRIPTION <#DESCRIPTION>`__ \| |                                   |
| `OPTIONS <#OPTIONS>`__ \|         |                                   |
| `FILES <#FILES>`__ \|             |                                   |
| `FILE FORMAT <#FILE_FORMAT>`__ \| |                                   |
| `NOTES <#NOTES>`__ \|             |                                   |
| `SEE ALSO <#SEE_ALSO>`__ \|       |                                   |
| `COLOPHON <#COLOPHON>`__          |                                   |
+-----------------------------------+-----------------------------------+
| .. container:: man-search-box     |                                   |
+-----------------------------------+-----------------------------------+

::

   selabel_media(5)        SELinux API documentation       selabel_media(5)

NAME
-------------------------------------------------

::

          selabel_media - userspace SELinux labeling interface and
          configuration file format for the media contexts backend


---------------------------------------------------------

::

          #include <selinux/label.h>

          int selabel_lookup(struct selabel_handle *hnd,
                             char **context,
                             const char *device_name, int unused);

          int selabel_lookup_raw(struct selabel_handle *hnd,
                             char **context,
                             const char *device_name, int unused);


---------------------------------------------------------------

::

          The media contexts backend maps from media device names such as
          "cdrom" or "floppy" into security contexts. It is used to find
          the appropriate context for establishing context mounts on these
          devices. The returned context must be freed using freecon(3).
          selabel_lookup(3) describes the function with its return and
          error codes.

          The integer lookup argument is currently unused and should be set
          to zero.

          Any messages generated by selabel_lookup(3) are sent to stderr by
          default, although this can be changed by selinux_set_callback(3).

          selabel_lookup_raw(3) behaves identically to selabel_lookup(3)
          but does not perform context translation.

          The FILES section details the configuration files used to
          determine the media context.


-------------------------------------------------------

::

          In addition to the global options described in selabel_open(3),
          this backend recognizes the following options:

          SELABEL_OPT_PATH
                 A non-null value for this option specifies a path to a
                 file that will be opened in lieu of the standard media
                 contexts file.


---------------------------------------------------

::

          The media context file used to retrieve a default context depends
          on the SELABEL_OPT_PATH parameter passed to selabel_open(3). If
          NULL, then the SELABEL_OPT_PATH value will default to the active
          policy media contexts location (as returned by
          selinux_media_context_path(3)), otherwise the actual
          SELABEL_OPT_PATH value specified is used.

          The default media contexts file is:
                 /etc/selinux/{SELINUXTYPE}/contexts/files/media

          Where {SELINUXTYPE} is the entry from the selinux configuration
          file config (see selinux_config(5)).


---------------------------------------------------------------

::

          Each line within the media file is as follows:
                 device_name context

          Where:
                 device_name
                        The media identifier (e.g. cdrom, floppy, disk and
                        usb).
                 context
                        The context to be used for labeling the device.

          Example:
                 # contexts/files/media
                 cdrom system_u:object_r:removable_device_t
                 floppy system_u:object_r:removable_device_t
                 disk system_u:object_r:fixed_disk_device_t


---------------------------------------------------

::

          If contexts are to be validated, then the global option
          SELABEL_OPT_VALIDATE must be set before calling selabel_open(3).
          If this is not set, then it is possible for an invalid context to
          be returned.


---------------------------------------------------------

::

          selinux(8), selabel_open(3), selabel_lookup(3), selabel_stats(3),
          selabel_close(3), selinux_set_callback(3),
          selinux_media_context_path(3), freecon(3), selinux_config(5)

COLOPHON
---------------------------------------------------------

::

          This page is part of the selinux (Security-Enhanced Linux user-
          space libraries and tools) project.  Information about the
          project can be found at 
          ⟨https://github.com/SELinuxProject/selinux/wiki⟩.  If you have a
          bug report for this manual page, see
          ⟨https://github.com/SELinuxProject/selinux/wiki/Contributing⟩.
          This page was obtained from the project's upstream Git repository
          ⟨https://github.com/SELinuxProject/selinux⟩ on 2021-08-27.  (At
          that time, the date of the most recent commit that was found in
          the repository was 2021-08-23.)  If you discover any rendering
          problems in this HTML version of the page, or you believe there
          is a better or more up-to-date source for the page, or you have
          corrections or improvements to the information in this COLOPHON
          (which is not part of the original manual page), send a mail to
          man-pages@man7.org

   Security Enhanced Linux        29 Nov 2011              selabel_media(5)

--------------

Pages that refer to this page:
`selabel_open(3) <../man3/selabel_open.3.html>`__

--------------

--------------

.. container:: footer

   +-----------------------+-----------------------+-----------------------+
   | HTML rendering        |                       | |Cover of TLPI|       |
   | created 2021-08-27 by |                       |                       |
   | `Michael              |                       |                       |
   | Ker                   |                       |                       |
   | risk <https://man7.or |                       |                       |
   | g/mtk/index.html>`__, |                       |                       |
   | author of `The Linux  |                       |                       |
   | Programming           |                       |                       |
   | Interface <https:     |                       |                       |
   | //man7.org/tlpi/>`__, |                       |                       |
   | maintainer of the     |                       |                       |
   | `Linux man-pages      |                       |                       |
   | project <             |                       |                       |
   | https://www.kernel.or |                       |                       |
   | g/doc/man-pages/>`__. |                       |                       |
   |                       |                       |                       |
   | For details of        |                       |                       |
   | in-depth **Linux/UNIX |                       |                       |
   | system programming    |                       |                       |
   | training courses**    |                       |                       |
   | that I teach, look    |                       |                       |
   | `here <https://ma     |                       |                       |
   | n7.org/training/>`__. |                       |                       |
   |                       |                       |                       |
   | Hosting by `jambit    |                       |                       |
   | GmbH                  |                       |                       |
   | <https://www.jambit.c |                       |                       |
   | om/index_en.html>`__. |                       |                       |
   +-----------------------+-----------------------+-----------------------+

--------------

.. container:: statcounter

   |Web Analytics Made Easy - StatCounter|

.. |Cover of TLPI| image:: https://man7.org/tlpi/cover/TLPI-front-cover-vsmall.png
   :target: https://man7.org/tlpi/
.. |Web Analytics Made Easy - StatCounter| image:: https://c.statcounter.com/7422636/0/9b6714ff/1/
   :class: statcounter
   :target: https://statcounter.com/
