.. container:: page-top

.. container:: nav-bar

   +----------------------------------+----------------------------------+
   | `m                               | `Linux/UNIX system programming   |
   | an7.org <../../../index.html>`__ | trainin                          |
   | > Linux >                        | g <http://man7.org/training/>`__ |
   | `man-pages <../index.html>`__    |                                  |
   +----------------------------------+----------------------------------+

--------------

bootup(7) — Linux manual page
=============================

+-----------------------------------+-----------------------------------+
| `NAME <#NAME>`__ \|               |                                   |
| `DESCRIPTION <#DESCRIPTION>`__ \| |                                   |
| `SYSTEM MANAGER B                 |                                   |
| OOTUP <#SYSTEM_MANAGER_BOOTUP>`__ |                                   |
| \|                                |                                   |
| `USER MANAGER S                   |                                   |
| TARTUP <#USER_MANAGER_STARTUP>`__ |                                   |
| \|                                |                                   |
| `BOOTUP IN THE INITI              |                                   |
| AL RAM DISK (INITRD) <#BOOTUP_IN_ |                                   |
| THE_INITIAL_RAM_DISK_(INITRD)>`__ |                                   |
| \|                                |                                   |
| `SYSTEM MANAGER SHUTD             |                                   |
| OWN <#SYSTEM_MANAGER_SHUTDOWN>`__ |                                   |
| \| `SEE ALSO <#SEE_ALSO>`__ \|    |                                   |
| `NOTES <#NOTES>`__ \|             |                                   |
| `COLOPHON <#COLOPHON>`__          |                                   |
+-----------------------------------+-----------------------------------+
| .. container:: man-search-box     |                                   |
+-----------------------------------+-----------------------------------+

::

   BOOTUP(7)                        bootup                        BOOTUP(7)

NAME
-------------------------------------------------

::

          bootup - System bootup process


---------------------------------------------------------------

::

          A number of different components are involved in the boot of a
          Linux system. Immediately after power-up, the system firmware
          will do minimal hardware initialization, and hand control over to
          a boot loader (e.g.  systemd-boot(7) or GRUB[1]) stored on a
          persistent storage device. This boot loader will then invoke an
          OS kernel from disk (or the network). On systems using EFI or
          other types of firmware, this firmware may also load the kernel
          directly.

          The kernel (optionally) mounts an in-memory file system, often
          generated by dracut(8), which looks for the root file system.
          Nowadays this is usually implemented as an initramfs — a
          compressed archive which is extracted when the kernel boots up
          into a lightweight in-memory file system based on tmpfs, but in
          the past normal file systems using an in-memory block device
          (ramdisk) were used, and the name "initrd" is still used to
          describe both concepts. It's the boot loader or the firmware that
          loads both the kernel and initrd/initramfs images into memory,
          but the kernel which interprets it as a file system.  systemd(1)
          may be used to manage services in the initrd, similarly to the
          real system.

          After the root file system is found and mounted, the initrd hands
          over control to the host's system manager (such as systemd(1))
          stored in the root file system, which is then responsible for
          probing all remaining hardware, mounting all necessary file
          systems and spawning all configured services.

          On shutdown, the system manager stops all services, unmounts all
          file systems (detaching the storage technologies backing them),
          and then (optionally) jumps back into the initrd code which
          unmounts/detaches the root file system and the storage it resides
          on. As a last step, the system is powered down.

          Additional information about the system boot process may be found
          in boot(7).


-----------------------------------------------------------------------------------

::

          At boot, the system manager on the OS image is responsible for
          initializing the required file systems, services and drivers that
          are necessary for operation of the system. On systemd(1) systems,
          this process is split up in various discrete steps which are
          exposed as target units. (See systemd.target(5) for detailed
          information about target units.) The boot-up process is highly
          parallelized so that the order in which specific target units are
          reached is not deterministic, but still adheres to a limited
          amount of ordering structure.

          When systemd starts up the system, it will activate all units
          that are dependencies of default.target (as well as recursively
          all dependencies of these dependencies). Usually, default.target
          is simply an alias of graphical.target or multi-user.target,
          depending on whether the system is configured for a graphical UI
          or only for a text console. To enforce minimal ordering between
          the units pulled in, a number of well-known target units are
          available, as listed on systemd.special(7).

          The following chart is a structural overview of these well-known
          units and their position in the boot-up logic. The arrows
          describe which units are pulled in and ordered before which other
          units. Units near the top are started before units nearer to the
          bottom of the chart.

                                           cryptsetup-pre.target veritysetup-pre.target
                                                                |
              (various low-level                                v
               API VFS mounts:             (various cryptsetup/veritysetup devices...)
               mqueue, configfs,                                |    |
               debugfs, ...)                                    v    |
               |                                  cryptsetup.target  |
               |  (various swap                                 |    |    remote-fs-pre.target
               |   devices...)                                  |    |     |        |
               |    |                                           |    |     |        v
               |    v                       local-fs-pre.target |    |     |  (network file systems)
               |  swap.target                       |           |    v     v                 |
               |    |                               v           |  remote-cryptsetup.target  |
               |    |  (various low-level  (various mounts and  |  remote-veritysetup.target |
               |    |   services: udevd,    fsck services...)   |             |    remote-fs.target
               |    |   tmpfiles, random            |           |             |             /
               |    |   seed, sysctl, ...)          v           |             |            /
               |    |      |                 local-fs.target    |             |           /
               |    |      |                        |           |             |          /
               \____|______|_______________   ______|___________/             |         /
                                           \ /                                |        /
                                            v                                 |       /
                                     sysinit.target                           |      /
                                            |                                 |     /
                     ______________________/|\_____________________           |    /
                    /              |        |      |               \          |   /
                    |              |        |      |               |          |  /
                    v              v        |      v               |          | /
               (various       (various      |  (various            |          |/
                timers...)      paths...)   |   sockets...)        |          |
                    |              |        |      |               |          |
                    v              v        |      v               |          |
              timers.target  paths.target   |  sockets.target      |          |
                    |              |        |      |               v          |
                    v              \_______ | _____/         rescue.service   |
                                           \|/                     |          |
                                            v                      v          |
                                        basic.target         rescue.target    |
                                            |                                 |
                                    ________v____________________             |
                                   /              |              \            |
                                   |              |              |            |
                                   v              v              v            |
                               display-    (various system   (various system  |
                           manager.service     services        services)      |
                                   |         required for        |            |
                                   |        graphical UIs)       v            v
                                   |              |            multi-user.target
              emergency.service    |              |              |
                      |            \_____________ | _____________/
                      v                          \|/
              emergency.target                    v
                                            graphical.target

          Target units that are commonly used as boot targets are
          emphasized. These units are good choices as goal targets, for
          example by passing them to the systemd.unit= kernel command line
          option (see systemd(1)) or by symlinking default.target to them.

          timers.target is pulled-in by basic.target asynchronously. This
          allows timers units to depend on services which become only
          available later in boot.


---------------------------------------------------------------------------------

::

          The system manager starts the user@uid.service unit for each
          user, which launches a separate unprivileged instance of systemd
          for each user — the user manager. Similarly to the system
          manager, the user manager starts units which are pulled in by
          default.target. The following chart is a structural overview of
          the well-known user units. For non-graphical sessions,
          default.target is used. Whenever the user logs into a graphical
          session, the login manager will start the
          graphical-session.target target that is used to pull in units
          required for the graphical session. A number of targets (shown on
          the right side) are started when specific hardware is available
          to the user.

                  (various           (various         (various
                   timers...)         paths...)        sockets...)    (sound devices)
                       |                  |                 |               |
                       v                  v                 v               v
                 timers.target      paths.target     sockets.target    sound.target
                       |                  |                 |
                       \______________   _|_________________/         (bluetooth devices)
                                      \ /                                   |
                                       V                                    v
                                 basic.target                          bluetooth.target
                                       |
                            __________/ \_______                      (smartcard devices)
                           /                    \                           |
                           |                    |                           v
                           |                    v                      smartcard.target
                           v            graphical-session-pre.target
               (various user services)          |                       (printers)
                           |                    v                           |
                           |       (services for the graphical session)     v
                           |                    |                       printer.target
                           v                    v
                    default.target      graphical-session.target


-----------------------------------------------------------------------------------------------------------------------

::

          The initial RAM disk implementation (initrd) can be set up using
          systemd as well. In this case, boot up inside the initrd follows
          the following structure.

          systemd detects that it is run within an initrd by checking for
          the file /etc/initrd-release. The default target in the initrd is
          initrd.target. The bootup process begins identical to the system
          manager bootup (see above) until it reaches basic.target. From
          there, systemd approaches the special target initrd.target.
          Before any file systems are mounted, it must be determined
          whether the system will resume from hibernation or proceed with
          normal boot. This is accomplished by
          systemd-hibernate-resume@.service which must be finished before
          local-fs-pre.target, so no filesystems can be mounted before the
          check is complete. When the root device becomes available,
          initrd-root-device.target is reached. If the root device can be
          mounted at /sysroot, the sysroot.mount unit becomes active and
          initrd-root-fs.target is reached. The service
          initrd-parse-etc.service scans /sysroot/etc/fstab for a possible
          /usr/ mount point and additional entries marked with the
          x-initrd.mount option. All entries found are mounted below
          /sysroot, and initrd-fs.target is reached. The service
          initrd-cleanup.service isolates to the initrd-switch-root.target,
          where cleanup services can run. As the very last step, the
          initrd-switch-root.service is activated, which will cause the
          system to switch its root to /sysroot.

                                                             : (beginning identical to above)
                                                             :
                                                             v
                                                       basic.target
                                                             |                                 emergency.service
                                      ______________________/|                                         |
                                     /                       |                                         v
                                     |            initrd-root-device.target                    emergency.target
                                     |                       |
                                     |                       v
                                     |                  sysroot.mount
                                     |                       |
                                     |                       v
                                     |             initrd-root-fs.target
                                     |                       |
                                     |                       v
                                     v            initrd-parse-etc.service
                              (custom initrd                 |
                               services...)                  v
                                     |            (sysroot-usr.mount and
                                     |             various mounts marked
                                     |               with fstab option
                                     |              x-initrd.mount...)
                                     |                       |
                                     |                       v
                                     |                initrd-fs.target
                                     \______________________ |
                                                            \|
                                                             v
                                                        initrd.target
                                                             |
                                                             v
                                                   initrd-cleanup.service
                                                        isolates to
                                                  initrd-switch-root.target
                                                             |
                                                             v
                                      ______________________/|
                                     /                       v
                                     |        initrd-udevadm-cleanup-db.service
                                     v                       |
                              (custom initrd                 |
                               services...)                  |
                                     \______________________ |
                                                            \|
                                                             v
                                                 initrd-switch-root.target
                                                             |
                                                             v
                                                 initrd-switch-root.service
                                                             |
                                                             v
                                                   Transition to Host OS


---------------------------------------------------------------------------------------

::

          System shutdown with systemd also consists of various target
          units with some minimal ordering structure applied:

                                                (conflicts with  (conflicts with
                                                  all system     all file system
                                                   services)     mounts, swaps,
                                                       |           cryptsetup/
                                                       |           veritysetup
                                                       |          devices, ...)
                                                       |                |
                                                       v                v
                                                shutdown.target    umount.target
                                                       |                |
                                                       \_______   ______/
                                                               \ /
                                                                v
                                                       (various low-level
                                                            services)
                                                                |
                                                                v
                                                          final.target
                                                                |
                          _____________________________________/ \_________________________________
                         /                         |                        |                      \
                         |                         |                        |                      |
                         v                         v                        v                      v
              systemd-reboot.service   systemd-poweroff.service   systemd-halt.service   systemd-kexec.service
                         |                         |                        |                      |
                         v                         v                        v                      v
                  reboot.target             poweroff.target            halt.target           kexec.target

          Commonly used system shutdown targets are emphasized.

          Note that systemd-halt.service(8), systemd-reboot.service,
          systemd-poweroff.service and systemd-kexec.service will
          transition the system and server manager (PID 1) into the second
          phase of system shutdown (implemented in the systemd-shutdown
          binary), which will unmount any remaining file systems, kill any
          remaining processes and release any other remaining resources, in
          a simple and robust fashion, without taking any service or unit
          concept into account anymore. At that point, regular applications
          and resources are generally terminated and released already, the
          second phase hence operates only as safety net for everything
          that couldn't be stopped or released for some reason during the
          primary, unit-based shutdown phase described above.


---------------------------------------------------------

::

          systemd(1), boot(7), systemd.special(7), systemd.target(5),
          systemd-halt.service(8), dracut(8)


---------------------------------------------------

::

           1. GRUB
              https://www.gnu.org/software/grub/

COLOPHON
---------------------------------------------------------

::

          This page is part of the systemd (systemd system and service
          manager) project.  Information about the project can be found at
          ⟨http://www.freedesktop.org/wiki/Software/systemd⟩.  If you have
          a bug report for this manual page, see
          ⟨http://www.freedesktop.org/wiki/Software/systemd/#bugreports⟩.
          This page was obtained from the project's upstream Git repository
          ⟨https://github.com/systemd/systemd.git⟩ on 2021-08-27.  (At that
          time, the date of the most recent commit that was found in the
          repository was 2021-08-27.)  If you discover any rendering
          problems in this HTML version of the page, or you believe there
          is a better or more up-to-date source for the page, or you have
          corrections or improvements to the information in this COLOPHON
          (which is not part of the original manual page), send a mail to
          man-pages@man7.org

   systemd 249                                                    BOOTUP(7)

--------------

Pages that refer to this page: `systemd(1) <../man1/systemd.1.html>`__, 
`org.freedesktop.systemd1(5) <../man5/org.freedesktop.systemd1.5.html>`__, 
`systemd-system.conf(5) <../man5/systemd-system.conf.5.html>`__, 
`boot(7) <../man7/boot.7.html>`__, 
`dracut.bootup(7) <../man7/dracut.bootup.7.html>`__, 
`systemd.special(7) <../man7/systemd.special.7.html>`__, 
`systemd-gpt-auto-generator(8) <../man8/systemd-gpt-auto-generator.8.html>`__, 
`systemd-halt.service(8) <../man8/systemd-halt.service.8.html>`__

--------------

--------------

.. container:: footer

   +-----------------------+-----------------------+-----------------------+
   | HTML rendering        |                       | |Cover of TLPI|       |
   | created 2021-08-27 by |                       |                       |
   | `Michael              |                       |                       |
   | Ker                   |                       |                       |
   | risk <https://man7.or |                       |                       |
   | g/mtk/index.html>`__, |                       |                       |
   | author of `The Linux  |                       |                       |
   | Programming           |                       |                       |
   | Interface <https:     |                       |                       |
   | //man7.org/tlpi/>`__, |                       |                       |
   | maintainer of the     |                       |                       |
   | `Linux man-pages      |                       |                       |
   | project <             |                       |                       |
   | https://www.kernel.or |                       |                       |
   | g/doc/man-pages/>`__. |                       |                       |
   |                       |                       |                       |
   | For details of        |                       |                       |
   | in-depth **Linux/UNIX |                       |                       |
   | system programming    |                       |                       |
   | training courses**    |                       |                       |
   | that I teach, look    |                       |                       |
   | `here <https://ma     |                       |                       |
   | n7.org/training/>`__. |                       |                       |
   |                       |                       |                       |
   | Hosting by `jambit    |                       |                       |
   | GmbH                  |                       |                       |
   | <https://www.jambit.c |                       |                       |
   | om/index_en.html>`__. |                       |                       |
   +-----------------------+-----------------------+-----------------------+

--------------

.. container:: statcounter

   |Web Analytics Made Easy - StatCounter|

.. |Cover of TLPI| image:: https://man7.org/tlpi/cover/TLPI-front-cover-vsmall.png
   :target: https://man7.org/tlpi/
.. |Web Analytics Made Easy - StatCounter| image:: https://c.statcounter.com/7422636/0/9b6714ff/1/
   :class: statcounter
   :target: https://statcounter.com/
